<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/277915; Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="318"/>

<div>
<span><div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><strong>访问者模式是对象的行为模式。访问者模式的目的是封装一些施加于某种数据结构元素之上的操作。一旦这些操作需要修改的话，接受这个操作的数据结构则可以保持不变。</strong></p><h1 style="margin: 0px; background-image: none; background-color: rgb(255, 255, 255); height: auto; padding-right: 0px; font-family: verdana, Arial, Helvetica, sans-serif; font-size: 16px; font-weight: bold; border-bottom-style: none; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-position: initial initial; background-repeat: initial initial;"><strong><span style="font-size: 18pt;">分派的概念</span><br style="clear: both;"/></strong></h1><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><strong>　　</strong>变量被声明时的类型叫做变量的静态类型(Static Type)，有些人又把静态类型叫做明显类型(Apparent Type)；而变量所引用的对象的真实类型又叫做变量的实际类型(Actual Type)。比如：</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;">
List list = <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">null</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">;
list </span>= <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span> ArrayList();
</pre></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　声明了一个变量list，它的静态类型（也叫明显类型）是List，而它的实际类型是ArrayList。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　根据对象的类型而对方法进行的选择，就是分派(Dispatch)，分派(Dispatch)又分为两种，即<strong>静态分派</strong>和<strong>动态分派</strong>。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　<strong>静态分派(Static Dispatch)</strong>发生在编译时期，分派根据静态类型信息发生。静态分派对于我们来说并不陌生，方法重载就是静态分派。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　<strong>动态分派(Dynamic Dispatch)</strong>发生在运行时期，动态分派动态地置换掉某个方法。</p><h2 style="padding: 0px 0px 0px 20px; margin: 0px; font-size: 21px; font-weight: bold; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　静态分派</h2><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　Java通过方法重载支持静态分派。用墨子骑马的故事作为例子，墨子可以骑白马或者黑马。墨子与白马、黑马和马的类图如下所示：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　在这个系统中，墨子由Mozi类代表</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image.gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Mozi {
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> ride(Horse h){
        System.out.println(</span>&quot;骑马&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> ride(WhiteHorse wh){
        System.out.println(</span>&quot;骑白马&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> ride(BlackHorse bh){
        System.out.println(</span>&quot;骑黑马&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">static</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> main(String[] args) {
        Horse wh </span>= <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> WhiteHorse();
        Horse bh </span>= <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> BlackHorse();
        Mozi mozi </span>= <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Mozi();
        mozi.ride(wh);
        mozi.ride(bh);
    }

}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [1].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　显然，Mozi类的ride()方法是由三个方法重载而成的。这三个方法分别接受马(Horse)、白马(WhiteHorse)、黑马(BlackHorse)等类型的参数。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　那么在运行时，程序会打印出什么结果呢？结果是程序会打印出相同的两行“骑马”。换言之，墨子发现他所骑的都是马。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　为什么呢？两次对ride()方法的调用传入的是不同的参数，也就是wh和bh。它们虽然具有不同的真实类型，但是它们的静态类型都是一样的，均是Horse类型。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　重载方法的分派是根据静态类型进行的，这个分派过程在编译时期就完成了。</p><h2 style="padding: 0px 0px 0px 20px; margin: 0px; font-size: 21px; font-weight: bold; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　动态分派</h2><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　Java通过方法的重写支持动态分派。用马吃草的故事作为例子，代码如下所示：</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [2].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Horse {
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> eat(){
        System.out.println(</span>&quot;马吃草&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [3].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [4].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> BlackHorse <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">extends</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Horse {
    
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> eat() {
        System.out.println(</span>&quot;黑马吃草&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [5].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [6].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Client {

    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">static</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> main(String[] args) {
        Horse h </span>= <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> BlackHorse();
        h.eat();
    }

}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [7].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　变量h的静态类型是Horse，而真实类型是BlackHorse。如果上面最后一行的eat()方法调用的是BlackHorse类的eat()方法，那么上面打印的就是“黑马吃草”；相反，如果上面的eat()方法调用的是Horse类的eat()方法，那么打印的就是“马吃草”。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　所以，问题的核心就是Java编译器在编译时期并不总是知道哪些代码会被执行，因为编译器仅仅知道对象的静态类型，而不知道对象的真实类型；而方法的调用则是根据对象的真实类型，而不是静态类型。这样一来，上面最后一行的eat()方法调用的是BlackHorse类的eat()方法，打印的是“黑马吃草”。</p><h2 style="padding: 0px 0px 0px 20px; margin: 0px; font-size: 21px; font-weight: bold; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　分派的类型</h2><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　一个方法所属的对象叫做方法的接收者，方法的接收者与方法的参数统称做方法的宗量。比如下面例子中的Test类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [8].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Test {

    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> print(String str){
        System.out.println(str);
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [9].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　在上面的类中，print()方法属于Test对象，所以它的接收者也就是Test对象了。print()方法有一个参数是str,它的类型是String。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　根据分派可以基于多少种宗量，可以将面向对象的语言划分为单分派语言(Uni-Dispatch)和多分派语言(Multi-Dispatch)。单分派语言根据一个宗量的类型进行对方法的选择，多分派语言根据多于一个的宗量的类型对方法进行选择。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　C++和Java均是单分派语言，多分派语言的例子包括CLOS和Cecil。按照这样的区分，Java就是<strong>动态的单分派语言</strong>，因为这种语言的动态分派仅仅会考虑到方法的接收者的类型，同时又是<strong>静态的多分派语言</strong>，因为这种语言对重载方法的分派会考虑到方法的接收者的类型以及方法的所有参数的类型。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　在一个支持动态单分派的语言里面，有两个条件决定了一个请求会调用哪一个操作：一是请求的名字，而是接收者的真实类型。单分派限制了方法的选择过程，使得只有一个宗量可以被考虑到，这个宗量通常就是方法的接收者。在Java语言里面，如果一个操作是作用于某个类型不明的对象上面，那么对这个对象的真实类型测试仅会发生一次，这就是动态的单分派的特征。</p><h2 style="padding: 0px 0px 0px 20px; margin: 0px; font-size: 21px; font-weight: bold; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　双重分派</h2><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　一个方法根据两个宗量的类型来决定执行不同的代码，这就是“双重分派”。Java语言不支持动态的多分派，也就意味着Java不支持动态的双分派。但是通过使用设计模式，也可以在Java语言里实现动态的双重分派。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　在Java中可以通过两次方法调用来达到两次分派的目的。类图如下所示：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　在图中有两个对象，左边的叫做West，右边的叫做East。现在West对象首先调用East对象的goEast()方法，并将它自己传入。在East对象被调用时，立即根据传入的参数知道了调用者是谁，于是反过来调用“调用者”对象的goWest()方法。通过两次调用将程序控制权轮番交给两个对象，其时序图如下所示：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　这样就出现了两次方法调用，程序控制权被两个对象像传球一样，首先由West对象传给了East对象，然后又被返传给了West对象。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　但是仅仅返传了一下球，并不能解决双重分派的问题。关键是怎样利用这两次调用，以及Java语言的动态单分派功能，使得在这种传球的过程中，能够触发两次单分派。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　动态单分派在Java语言中是在子类重写父类的方法时发生的。换言之，West和East都必须分别置身于自己的类型等级结构中，如下图所示：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><h3 style="font-size: 16px; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(214, 214, 214); color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-weight: bold; font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　源代码</h3><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　West类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [10].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">abstract</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> West {
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">abstract</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goWest1(SubEast1 east);
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">abstract</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goWest2(SubEast2 east);
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [11].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　SubWest1类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [12].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> SubWest1 <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">extends</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> West{
    
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goWest1(SubEast1 east) {
        
        System.out.println(</span>&quot;SubWest1 + &quot; +<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> east.myName1());
    }
    
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goWest2(SubEast2 east) {
        
        System.out.println(</span>&quot;SubWest1 + &quot; +<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> east.myName2());
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [13].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　SubWest2类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [14].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> SubWest2 <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">extends</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> West{
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goWest1(SubEast1 east) {
        
        System.out.println(</span>&quot;SubWest2 + &quot; +<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> east.myName1());
    }
    
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goWest2(SubEast2 east) {
        
        System.out.println(</span>&quot;SubWest2 + &quot; +<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> east.myName2());
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [15].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　East类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">abstract</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> East {

    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">abstract</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goEast(West west);
}</span></pre></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　SubEast1类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [16].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> SubEast1 <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">extends</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> East{
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goEast(West west) {
        west.goWest1(</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">this</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> String myName1(){
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">return</span> &quot;SubEast1&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">;
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [17].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　SubEast2类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [18].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> SubEast2 <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">extends</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> East{
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> goEast(West west) {
        west.goWest2(</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">this</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> String myName2(){
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">return</span> &quot;SubEast2&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">;
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [19].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　客户端类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [20].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Client {

    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">static</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> main(String[] args) {
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">//</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">组合1</span>
        East east = <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> SubEast1();
        West west </span>= <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> SubWest1();
        east.goEast(west);
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">//</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">组合2</span>
        east = <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> SubEast1();
        west </span>= <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> SubWest2();
        east.goEast(west);
    }

}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [21].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　运行结果如下</p><hr style="color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">SubWest1 + SubEast1<br style="clear: both;"/>
SubWest2 + SubEast1</p><hr style="color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"> </p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　系统运行时，会首先创建SubWest1和SubEast1对象，然后客户端调用SubEast1的goEast()方法，并将SubWest1对象传入。<span style="color: rgb(255, 0, 0);">由于SubEast1对象重写了其超类East的goEast()方法，因此，这个时候就发生了一次动态的单分派</span>。当SubEast1对象接到调用时，会从参数中得到SubWest1对象，所以它就立即调用这个对象的goWest1()方法，并将自己传入。由于SubEast1对象有权选择调用哪一个对象，因此，在此时又进行一次动态的方法分派。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　这个时候SubWest1对象就得到了SubEast1对象。通过调用这个对象myName1()方法，就可以打印出自己的名字和SubEast对象的名字，其时序图如下所示：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　由于这两个名字一个来自East等级结构，另一个来自West等级结构中，因此，它们的组合式是动态决定的。这就是动态双重分派的实现机制。</p><h1 style="margin: 0px; background-image: none; background-color: rgb(255, 255, 255); height: auto; padding-right: 0px; font-family: verdana, Arial, Helvetica, sans-serif; font-size: 16px; font-weight: bold; border-bottom-style: none; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-position: initial initial; background-repeat: initial initial;"><span style="font-size: 18pt;">访问者模式的结构</span></h1><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　访问者模式适用于数据结构相对未定的系统，它把数据结构和作用于结构上的操作之间的耦合解脱开，使得操作集合可以相对自由地演化。访问者模式的简略图如下所示：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="data:image%2Fpng;base64,iVBORw0KGgoAAAANSUhEUgAAAPUAAABaCAIAAADvmYcJAAAD7klEQVR4nO3dr1IjYRAE8FjcPgJy5ScjI5F5BCQykjeIRCJ5BCQSiVyJREZGrtwTqUqlcsmQnZD9pnv65466P9MzTQoIF2aDCK9Z7QFEbkj9FmbqtzA73e9SyoxdKWXiXd+CLmU73e%2FZjP9xnSMjRwrbNRnVb2wcKWzqtwdHRo4UNvXbAzHjarXabreHb0FMMZb67YGYseu6xWJxWHHEFGOp3x6gGY8qDppiFPXbAzfjYcVxU1xO%2FfaAzrivOHSKC6nfHugZdxVHT3EJ9dvjls+4Tar2Im%2Fumoyp+117hKtst1s9fv%2F+Z%2F%2F8b0QBnXFX7q7roFNcSP32wM24L%2FeAnOJy6rcHaMbDcg+wKUZRvz0QMx6Ve8BMMZb67YGYcblcHpZ7wEwxlvrtwZGRI4VN%2FfbgyMiRwqZ+e3Bk5Ehh+%2Ft+N01zy2fcTri7u5v4X2yaxr21OHQpW4j3%2FvV6XUp5enqqPYj8Au5S9fv98%2FPTtm3f9%2FP5%2FOvrq%2FY4chbiper3++Hh4ePjYxiGrus4XrOBFeKlKvf7%2Ff19uVzuf7larV5eXirOI+eAXqpmv%2Fu+v7+%2F32w2xlskAtxL1ez3yceAo8cJiQD3UtX6bXwMt%2F84TyKAvlS1fhufg+8%2FT594JDkJ+lJ1+v36+mp%2FDXW9Xj8%2FP082j5yDfqkK%2Fd5sNm3bHr0O05G+70sp39%2Ffk00l%2FyO4VIV+Pz4+vr29%2FfrbPj8%2FF4vF7ceRswguNXW%2FR+3iwv3KLXBcaup+z+fzUd9b07btxBPKDsel6j8%2FvzNL8H2eHLAuFWVWrK1lhnWpKLNibS0zrEtFmRVra5lhXSrKrFhbywzrUlFmxdpaZliXijIr1tYyw7pUlFmxtpYZ1qWizIq1tcywLhVlVqytZYZ1qSizYm0tM6xLRZkVa2uZYV0qyqxYW8sM61JRZsXaWmZYl4oyK9bWMsO6VJRZsbaWGdalosyKtbXMsC4VZVasrWWGdakos2JtLTOsS0WZFWtrmWFdKsqsWFvLDOtSUWbF2lpmWJeKMivW1jLDulSUWbG2lhnWpaLMirW1zLAuFWVWrK1lhnWp07OWUka9NhcilJ+QZNOlbPr5xdg4Utiuyah+Y+NIYVO%2FPTgycqSwqd8eHBk5UtjUbw+OjBwpbOq3B0dGjhQ29duDIyNHCpv67cGRkSOFTf324MjIkcKmfntwZORIYVO%2FPTgycqSwqd8eHBk5UtjUbw+OjBwpbOq3B0dGjhQ29duDIyNHCpv67cGRkSOFTf324MjIkcKmfntwZORIYVO%2FPTgycqSw%2FX2%2Fm6bx%2FVc5IE3TuLcWhy5l43%2Fvl8zUb2Gmfgsz9VuYqd%2FC7B%2FgsA%2F0MurZDAAAAABJRU5ErkJggg==" style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　数据结构的每一个节点都可以接受一个访问者的调用，此节点向访问者对象传入节点对象，而访问者对象则反过来执行节点对象的操作。这样的过程叫做“双重分派”。节点调用访问者，将它自己传入，访问者则将某算法针对此节点执行。访问者模式的示意性类图如下所示：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　<img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　访问者模式涉及到的角色如下：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>抽象访问者(Visitor)角色：</strong>声明了一个或者多个方法操作，形成所有的具体访问者角色必须实现的接口。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>具体访问者(ConcreteVisitor)角色：</strong>实现抽象访问者所声明的接口，也就是抽象访问者所声明的各个访问操作。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>抽象节点(Node)角色：</strong>声明一个接受操作，接受一个访问者对象作为一个参数。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>具体节点(ConcreteNode)角色：</strong>实现了抽象节点所规定的接受操作。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>结构对象(ObjectStructure)角色：</strong>有如下的责任，可以遍历结构中的所有元素；如果需要，提供一个高层次的接口让访问者对象可以访问每一个元素；如果需要，可以设计成一个复合对象或者一个聚集，如List或Set。</p><h3 style="font-size: 16px; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(214, 214, 214); color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-weight: bold; font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　源代码</h3><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　可以看到，抽象访问者角色为每一个具体节点都准备了一个访问操作。由于有两个节点，因此，对应就有两个访问操作。</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [22].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">interface</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Visitor {
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 对应于NodeA的访问操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span>
    <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> visit(NodeA node);
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 对应于NodeB的访问操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span>
    <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> visit(NodeB node);
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [23].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　具体访问者VisitorA类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [24].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> VisitorA <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">implements</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Visitor {
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 对应于NodeA的访问操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> visit(NodeA node) {
        System.out.println(node.operationA());
    }
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 对应于NodeB的访问操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> visit(NodeB node) {
        System.out.println(node.operationB());
    }

}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [25].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　具体访问者VisitorB类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [26].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> VisitorB <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">implements</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Visitor {
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 对应于NodeA的访问操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> visit(NodeA node) {
        System.out.println(node.operationA());
    }
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 对应于NodeB的访问操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> visit(NodeB node) {
        System.out.println(node.operationB());
    }

}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [27].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　抽象节点类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [28].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">abstract</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Node {
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 接受操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span>
    <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">abstract</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> accept(Visitor visitor);
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [29].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　具体节点类NodeA</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [30].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> NodeA <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">extends</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Node{
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 接受操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> accept(Visitor visitor) {
        visitor.visit(</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">this</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * NodeA特有的方法
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span>
    <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> String operationA(){
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">return</span> &quot;NodeA&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">;
    }

}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [31].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　具体节点类NodeB</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [32].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span> NodeB <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">extends</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Node{
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 接受方法
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">
    @Override
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> accept(Visitor visitor) {
        visitor.visit(</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">this</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">);
    }
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * NodeB特有的方法
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span>
    <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> String operationB(){
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">return</span> &quot;NodeB&quot;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">;
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [33].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　结构对象角色类，这个结构对象角色持有一个聚集，并向外界提供add()方法作为对聚集的管理操作。通过调用这个方法，可以动态地增加一个新的节点。</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [34].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> ObjectStructure {
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">private</span> List&lt;Node&gt; nodes = <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span> ArrayList&lt;Node&gt;<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">();
    
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 执行方法操作
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span>
    <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> action(Visitor visitor){
        
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">for</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);">(Node node : nodes)
        {
            node.accept(visitor);
        }
        
    }
    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">/**</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">
     * 添加一个新元素
     </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">*/</span>
    <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> add(Node node){
        nodes.add(node);
    }
}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [35].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　客户端类</p><div style="word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; color: rgb(0, 0, 0); font-family: &apos;Courier New&apos; !important; font-size: 12px !important; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [36].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: &apos;Courier New&apos; !important; font-size: 12px !important;"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">class</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> Client {

    </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">public</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">static</span> <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">void</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> main(String[] args) {
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">//</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">创建一个结构对象</span>
        ObjectStructure os = <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> ObjectStructure();
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">//</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">给结构增加一个节点</span>
        os.add(<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> NodeA());
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">//</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">给结构增加一个节点</span>
        os.add(<span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> NodeB());
        </span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">//</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 128, 0);">创建一个访问者</span>
        Visitor visitor = <span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 255);">new</span><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; color: rgb(0, 0, 0);"> VisitorA();
        os.action(visitor);
    }

}</span></pre><div style="word-wrap: break-word; margin-top: 5px; background-color: rgb(245, 245, 245);"><span style="font-family: &apos;Courier New&apos; !important; font-size: 12px !important; padding-right: 5px;"><a style="color: rgb(46, 156, 233); text-decoration: none; background-color: rgb(245, 245, 245) !important; border: none !important;" title="复制代码"><img src="design_visitor_3_files/Image [37].gif" type="image/gif" alt="复制代码" style="border: none !important; background-color: rgb(245, 245, 245) !important; max-width: 900px; height: auto;"/></a></span></div></div><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　虽然在这个示意性的实现里并没有出现一个复杂的具有多个树枝节点的对象树结构，但是，在实际系统中访问者模式通常是用来处理复杂的对象树结构的，而且访问者模式可以用来处理跨越多个等级结构的树结构问题。这正是访问者模式的功能强大之处。</p><h3 style="font-size: 16px; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(214, 214, 214); color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-weight: bold; font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　准备过程时序图</h3><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　首先，这个示意性的客户端创建了一个结构对象，然后将一个新的NodeA对象和一个新的NodeB对象传入。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　其次，客户端创建了一个VisitorA对象，并将此对象传给结构对象。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　然后，客户端调用结构对象聚集管理方法，将NodeA和NodeB节点加入到结构对象中去。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　最后，客户端调用结构对象的行动方法action()，启动访问过程。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　<img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><h3 style="font-size: 16px; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(214, 214, 214); color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-weight: bold; font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;">　　访问过程时序图</h3><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　<img style="border: 0px; max-width: 900px; display: block; margin-left: auto; margin-right: auto; height: auto;"></img></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　结构对象会遍历它自己所保存的聚集中的所有节点，在本系统中就是节点NodeA和NodeB。首先NodeA会被访问到，这个访问是由以下的操作组成的：</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　（1）NodeA对象的接受方法accept()被调用，并将VisitorA对象本身传入；</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　（2）NodeA对象反过来调用VisitorA对象的访问方法，并将NodeA对象本身传入；</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　（3）VisitorA对象调用NodeA对象的特有方法operationA()。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　从而就完成了双重分派过程，接着，NodeB会被访问，这个访问的过程和NodeA被访问的过程是一样的，这里不再叙述。</p><h1 style="margin: 0px; background-image: none; background-color: rgb(255, 255, 255); height: auto; padding-right: 0px; font-family: verdana, Arial, Helvetica, sans-serif; font-size: 16px; font-weight: bold; border-bottom-style: none; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-position: initial initial; background-repeat: initial initial;"><span style="font-size: 18pt;">访问者模式的优点</span></h1><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>好的扩展性</strong></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　能够在不修改对象结构中的元素的情况下，为对象结构中的元素添加新的功能。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>好的复用性</strong></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　可以通过访问者来定义整个对象结构通用的功能，从而提高复用程度。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>分离无关行为</strong></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　可以通过访问者来分离无关的行为，把相关的行为封装在一起，构成一个访问者，这样每一个访问者的功能都比较单一。</p><h1 style="margin: 0px; background-image: none; background-color: rgb(255, 255, 255); height: auto; padding-right: 0px; font-family: verdana, Arial, Helvetica, sans-serif; font-size: 16px; font-weight: bold; border-bottom-style: none; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-position: initial initial; background-repeat: initial initial;"><span style="font-size: 18pt;">访问者模式的缺点</span></h1><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　　<strong>对象结构变化很困难</strong></p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　不适用于对象结构中的类经常变化的情况，因为对象结构发生了改变，访问者的接口和访问者的实现都要发生相应的改变，代价太高。</p><p style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">　　●　<strong>　破坏封装</strong></p><div style="word-wrap: break-word; margin: 10px auto; text-indent: 0px; color: rgb(0, 0, 0); font-family: &apos;ms shell dlg&apos;; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 14px;"><div>　　访问者模式通常需要对象结构开放内部数据给访问者和ObjectStructrue，这破坏了对象的封装性。</div></div></div></span>
</div></body></html> 