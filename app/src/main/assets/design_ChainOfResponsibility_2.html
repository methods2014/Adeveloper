<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/277915; Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="306"/>

<div>
<span><div><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;"><strong>责任链模式是一种对象的行为模式。在责任链模式里，很多对象由每一个对象对其下家的引用而连接起来形成一条链。请求在这个链上传递，直到链上的某一个对象决定处理此请求。发出这个请求的客户端并不知道链上的哪一个对象最终处理这个请求，这使得系统可以在不影响客户端的情况下动态地重新组织和分配责任。</strong></p><hr style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-family: &apos;ms shell dlg&apos;;"/><h1 style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); height: auto; font-family: verdana, Arial, Helvetica, sans-serif; font-size: 16px; border-bottom-style: none;"><a name="t0" style="color: rgb(51, 102, 153); text-decoration: none;"></a><span style="font-size: 18pt;">从击鼓传花谈起<strong><br style="clear: both;"/></strong></span></h1><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　击鼓传花是一种热闹而又紧张的饮酒游戏。在酒宴上宾客依次坐定位置，由一人击鼓，击鼓的地方与传花的地方是分开的，以示公正。开始击鼓时，花束就开始依次传递，鼓声一落，如果花束在某人手中，则该人就得饮酒。</div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　比如说，贾母、贾赦、贾政、贾宝玉和贾环是五个参加击鼓传花游戏的传花者，他们组成一个环链。击鼓者将花传给贾母，开始传花游戏。花由贾母传给贾赦，由贾赦传给贾政，由贾政传给贾宝玉，又贾宝玉传给贾环，由贾环传回给贾母，如此往复，如下图所示。当鼓声停止时，手中有花的人就得执行酒令。</div></div><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　击鼓传花便是责任链模式的应用。责任链可能是一条直线、一个环链或者一个树结构的一部分。</p><div style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); height: auto; font-family: verdana, Arial, Helvetica, sans-serif; border-bottom-style: none; font-weight: bold; font-size: 16px;"><div><span style="font-size: 18pt;">责任链模式的结构</span></div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　下面使用了一个责任链模式的最简单的实现。</div></div><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　责任链模式涉及到的角色如下所示：</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　●　　<strong>抽象处理者(Handler)角色：</strong>定义出一个处理请求的接口。如果需要，接口可以定义 出一个方法以设定和返回对下家的引用。这个角色通常由一个Java抽象类或者Java接口实现。上图中Handler类的聚合关系给出了具体子类对下家的引用，抽象方法handleRequest()规范了子类处理请求的操作。</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　●　　<strong>具体处理者(ConcreteHandler)角色：</strong>具体处理者接到请求后，可以选择将请求处理掉，或者将请求传给下家。由于具体处理者持有对下家的引用，因此，如果需要，具体处理者可以访问下家。</p><h3 style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 14px; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(214, 214, 214); font-family: &apos;ms shell dlg&apos;;"><a name="t2" style="color: rgb(51, 102, 153); text-decoration: none;"></a>源代码</h3><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　抽象处理者角色</div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">abstract</span> <span style="color: rgb(0, 0, 255);">class</span> Handler {<br/>
   <br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 持有后继的责任对象<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">protected</span> Handler successor;<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 示意处理请求的方法，虽然这个示意方法是没有传入参数的<br/>
     * 但实际是可以传入参数的，根据具体需要来选择是否传递参数<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">abstract</span> <span style="color: rgb(0, 0, 255);">void</span> handleRequest();<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 取值方法<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">public</span> Handler getSuccessor() {<br/>
        <span style="color: rgb(0, 0, 255);">return</span> successor;<br/>
    }<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 赋值方法，设置后继的责任对象<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">void</span> setSuccessor(Handler successor) {<br/>
        <span style="color: rgb(0, 0, 255);">this</span>.successor = successor;<br/>
    }<br/>
   <br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　具体处理者角色</div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">class</span> ConcreteHandler <span style="color: rgb(0, 0, 255);">extends</span> Handler {<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 处理方法，调用此方法处理请求<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    @Override<br/>
    <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">void</span> handleRequest() {<br/>
        <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
         * 判断是否有后继的责任对象<br/>
         * 如果有，就转发请求给后继的责任对象<br/>
         * 如果没有，则处理请求<br/>
         </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
        <span style="color: rgb(0, 0, 255);">if</span>(getSuccessor() != <span style="color: rgb(0, 0, 255);">null</span>)<br/>
        {           <br/>
            System.out.println(&quot;放过请求&quot;);<br/>
            getSuccessor().handleRequest();           <br/>
        }<span style="color: rgb(0, 0, 255);">else</span><br/>
        {           <br/>
            System.out.println(&quot;处理请求&quot;);<br/>
        }<br/>
    }<br/><br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　客户端类</div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">class</span> Client {<br/><br/>
    <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">static</span> <span style="color: rgb(0, 0, 255);">void</span> main(String[] args) {<br/>
        <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">组装责任链</span><br/>
        Handler handler1 = <span style="color: rgb(0, 0, 255);">new</span> ConcreteHandler();<br/>
        Handler handler2 = <span style="color: rgb(0, 0, 255);">new</span> ConcreteHandler();<br/>
        handler1.setSuccessor(handler2);<br/>
        <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">提交请求</span>        handler1.handleRequest();<br/>
    }<br/><br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　可以看出，客户端创建了两个处理者对象，并指定第一个处理者对象的下家是第二个处理者对象，而第二个处理者对象没有下家。然后客户端将请求传递给第一个处理者对象。</div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　由于本示例的传递逻辑非常简单：只要有下家，就传给下家处理；如果没有下家，就自行处理。因此，第一个处理者对象接到请求后，会将请求传递给第二个处理者对象。由于第二个处理者对象没有下家，于是自行处理请求。活动时序图如下所示。</div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div><br/></div></div><h1 style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); height: auto; font-family: verdana, Arial, Helvetica, sans-serif; font-size: 16px; border-bottom-style: none;"><a name="t3" style="color: rgb(51, 102, 153); text-decoration: none;"></a><span style="font-size: 18pt;">使用场景</span></h1><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　来考虑这样一个功能:申请聚餐费用的管理。</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　很多公司都是这样的福利，就是项目组或者是部门可以向公司申请一些聚餐费用，用于组织项目组成员或者是部门成员进行聚餐活动。</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　申请聚餐费用的大致流程一般是：由申请人先填写申请单，然后交给领导审批，如果申请批准下来，领导会通知申请人审批通过，然后申请人去财务领取费用，如果没有批准下来，领导会通知申请人审批未通过，此事也就此作罢。</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　不同级别的领导，对于审批的额度是不一样的，比如，项目经理只能审批500元以内的申请；部门经理能审批1000元以内的申请；而总经理可以审核任意额度的申请。</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　也就是说，当某人提出聚餐费用申请的请求后，该请求会经由项目经理、部门经理、总经理之中的某一位领导来进行相应的处理，但是提出申请的人并不知道最终会由谁来处理他的请求，一般申请人是把自己的申请提交给项目经理，或许最后是由总经理来处理他的请求。</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　</p><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　可以使用责任链模式来实现上述功能：当某人提出聚餐费用申请的请求后，该请求会在 <strong>项目经理—〉部门经理—〉总经理 </strong>这样一条领导处理链上进行传递，发出请求的人并不知道谁会来处理他的请求，每个领导会根据自己的职责范围，来判断是处理请求还是把请求交给更高级别的领导，只要有领导处理了，传递就结束了。</div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　需要把每位领导的处理独立出来，实现成单独的职责处理对象，然后为它们提供一个公共的、抽象的父职责对象，这样就可以在客户端来动态地组合职责链，实现不同的功能要求了。</div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　</div></div><h3 style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 14px; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: rgb(214, 214, 214); font-family: &apos;ms shell dlg&apos;;"><a name="t4" style="color: rgb(51, 102, 153); text-decoration: none;"></a>源代码</h3><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　抽象处理者角色类</div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">abstract</span> <span style="color: rgb(0, 0, 255);">class</span> Handler {<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 持有下一个处理请求的对象<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">protected</span> Handler successor = <span style="color: rgb(0, 0, 255);">null</span>;<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 取值方法<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">public</span> Handler getSuccessor() {<br/>
        <span style="color: rgb(0, 0, 255);">return</span> successor;<br/>
    }<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 设置下一个处理请求的对象<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">void</span> setSuccessor(Handler successor) {<br/>
        <span style="color: rgb(0, 0, 255);">this</span>.successor = successor;<br/>
    }<br/>
    <span style="color: rgb(0, 128, 0);">/**</span><span style="color: rgb(0, 128, 0);"><br/>
     * 处理聚餐费用的申请<br/>
     * </span><span style="color: rgb(128, 128, 128);">@param</span><span style="color: rgb(0, 128, 0);"> user    申请人<br/>
     * </span><span style="color: rgb(128, 128, 128);">@param</span><span style="color: rgb(0, 128, 0);"> fee    申请的钱数<br/>
     * </span><span style="color: rgb(128, 128, 128);">@return</span><span style="color: rgb(0, 128, 0);">        成功或失败的具体通知<br/>
     </span><span style="color: rgb(0, 128, 0);">*/</span><br/>
    <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">abstract</span> String handleFeeRequest(String user , <span style="color: rgb(0, 0, 255);">double</span> fee);<br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　具体处理者角色</div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">class</span> ProjectManager <span style="color: rgb(0, 0, 255);">extends</span> Handler {<br/><br/>
    @Override<br/>
    <span style="color: rgb(0, 0, 255);">public</span> String handleFeeRequest(String user, <span style="color: rgb(0, 0, 255);">double</span> fee) {<br/>
       <br/>
        String str = &quot;&quot;;<br/>
        <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">项目经理权限比较小，只能在500以内</span><br/>
        <span style="color: rgb(0, 0, 255);">if</span>(fee &lt; 500)<br/>
        {<br/>
            <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">为了测试，简单点，只同意张三的请求</span><br/>
            <span style="color: rgb(0, 0, 255);">if</span>(&quot;张三&quot;.equals(user))<br/>
            {<br/>
                str = &quot;成功：项目经理同意【&quot; + user + &quot;】的聚餐费用，金额为&quot; + fee + &quot;元&quot;;   <br/>
            }<span style="color: rgb(0, 0, 255);">else</span><br/>
            {<br/>
                <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">其他人一律不同意</span><br/>
                str = &quot;失败：项目经理不同意【&quot; + user + &quot;】的聚餐费用，金额为&quot; + fee + &quot;元&quot;;<br/>
            }<br/>
        }<span style="color: rgb(0, 0, 255);">else</span><br/>
        {<br/>
            <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">超过500，继续传递给级别更高的人处理</span><br/>
            <span style="color: rgb(0, 0, 255);">if</span>(getSuccessor() != <span style="color: rgb(0, 0, 255);">null</span>)<br/>
            {<br/>
                <span style="color: rgb(0, 0, 255);">return</span> getSuccessor().handleFeeRequest(user, fee);<br/>
            }<br/>
        }<br/>
        <span style="color: rgb(0, 0, 255);">return</span> str;<br/>
    }<br/><br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">class</span> DeptManager <span style="color: rgb(0, 0, 255);">extends</span> Handler {<br/><br/>
    @Override<br/>
    <span style="color: rgb(0, 0, 255);">public</span> String handleFeeRequest(String user, <span style="color: rgb(0, 0, 255);">double</span> fee) {<br/>
       <br/>
        String str = &quot;&quot;;<br/>
        <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">部门经理的权限只能在1000以内</span><br/>
        <span style="color: rgb(0, 0, 255);">if</span>(fee &lt; 1000)<br/>
        {<br/>
            <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">为了测试，简单点，只同意张三的请求</span><br/>
            <span style="color: rgb(0, 0, 255);">if</span>(&quot;张三&quot;.equals(user))<br/>
            {<br/>
                str = &quot;成功：部门经理同意【&quot; + user + &quot;】的聚餐费用，金额为&quot; + fee + &quot;元&quot;;   <br/>
            }<span style="color: rgb(0, 0, 255);">else</span><br/>
            {<br/>
                <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">其他人一律不同意</span><br/>
                str = &quot;失败：部门经理不同意【&quot; + user + &quot;】的聚餐费用，金额为&quot; + fee + &quot;元&quot;;<br/>
            }<br/>
        }<span style="color: rgb(0, 0, 255);">else</span><br/>
        {<br/>
            <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">超过1000，继续传递给级别更高的人处理</span><br/>
            <span style="color: rgb(0, 0, 255);">if</span>(getSuccessor() != <span style="color: rgb(0, 0, 255);">null</span>)<br/>
            {<br/>
                <span style="color: rgb(0, 0, 255);">return</span> getSuccessor().handleFeeRequest(user, fee);<br/>
            }<br/>
        }<br/>
        <span style="color: rgb(0, 0, 255);">return</span> str;<br/>
    }<br/><br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">class</span> GeneralManager <span style="color: rgb(0, 0, 255);">extends</span> Handler {<br/><br/>
    @Override<br/>
    <span style="color: rgb(0, 0, 255);">public</span> String handleFeeRequest(String user, <span style="color: rgb(0, 0, 255);">double</span> fee) {<br/>
       <br/>
        String str = &quot;&quot;;<br/>
        <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">总经理的权限很大，只要请求到了这里，他都可以处理</span><br/>
        <span style="color: rgb(0, 0, 255);">if</span>(fee &gt;= 1000)<br/>
        {<br/>
            <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">为了测试，简单点，只同意张三的请求</span><br/>
            <span style="color: rgb(0, 0, 255);">if</span>(&quot;张三&quot;.equals(user))<br/>
            {<br/>
                str = &quot;成功：总经理同意【&quot; + user + &quot;】的聚餐费用，金额为&quot; + fee + &quot;元&quot;;   <br/>
            }<span style="color: rgb(0, 0, 255);">else</span><br/>
            {<br/>
                <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">其他人一律不同意</span><br/>
                str = &quot;失败：总经理不同意【&quot; + user + &quot;】的聚餐费用，金额为&quot; + fee + &quot;元&quot;;<br/>
            }<br/>
        }<span style="color: rgb(0, 0, 255);">else</span><br/>
        {<br/>
            <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">如果还有后继的处理对象，继续传递</span><br/>
            <span style="color: rgb(0, 0, 255);">if</span>(getSuccessor() != <span style="color: rgb(0, 0, 255);">null</span>)<br/>
            {<br/>
                <span style="color: rgb(0, 0, 255);">return</span> getSuccessor().handleFeeRequest(user, fee);<br/>
            }<br/>
        }<br/>
        <span style="color: rgb(0, 0, 255);">return</span> str;<br/>
    }<br/><br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　客户端类</div></div><div style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; font-family: &apos;Courier New&apos;; border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px;"><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div><div style="margin-top: 0px; margin-bottom: 0px; font-family: &apos;Courier New&apos;;"><span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">class</span> Client {<br/><br/>
    <span style="color: rgb(0, 0, 255);">public</span> <span style="color: rgb(0, 0, 255);">static</span> <span style="color: rgb(0, 0, 255);">void</span> main(String[] args) {<br/>
        <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">先要组装责任链</span><br/>
        Handler h1 = <span style="color: rgb(0, 0, 255);">new</span> GeneralManager();<br/>
        Handler h2 = <span style="color: rgb(0, 0, 255);">new</span> DeptManager();<br/>
        Handler h3 = <span style="color: rgb(0, 0, 255);">new</span> ProjectManager();<br/>
        h3.setSuccessor(h2);<br/>
        h2.setSuccessor(h1);<br/>
       <br/>
        <span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);">开始测试</span><br/>
        String test1 = h3.handleFeeRequest(&quot;张三&quot;, 300);<br/>
        System.out.println(&quot;test1 = &quot; + test1);<br/>
        String test2 = h3.handleFeeRequest(&quot;李四&quot;, 300);<br/>
        System.out.println(&quot;test2 = &quot; + test2);<br/>
        System.out.println(&quot;---------------------------------------&quot;);<br/>
       <br/>
        String test3 = h3.handleFeeRequest(&quot;张三&quot;, 700);<br/>
        System.out.println(&quot;test3 = &quot; + test3);<br/>
        String test4 = h3.handleFeeRequest(&quot;李四&quot;, 700);<br/>
        System.out.println(&quot;test4 = &quot; + test4);<br/>
        System.out.println(&quot;---------------------------------------&quot;);<br/>
       <br/>
        String test5 = h3.handleFeeRequest(&quot;张三&quot;, 1500);<br/>
        System.out.println(&quot;test5 = &quot; + test5);<br/>
        String test6 = h3.handleFeeRequest(&quot;李四&quot;, 1500);<br/>
        System.out.println(&quot;test6 = &quot; + test6);<br/>
    }<br/><br/>
}<br/></div><div style="word-wrap: break-word; margin-top: 5px;"><div><br/></div></div></div><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>运行结果如下所示：</div></div><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;"> </p><h1 style="margin: 0px; padding: 0px; color: rgb(51, 51, 51); font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); height: auto; font-family: verdana, Arial, Helvetica, sans-serif; font-size: 16px; border-bottom-style: none;"><a name="t5" style="color: rgb(51, 102, 153); text-decoration: none;"></a><span style="font-size: 18pt;">纯的与不纯的责任链模式</span></h1><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　一个纯的责任链模式要求一个具体的处理者对象只能在两个行为中选择一个：一是承担责任，而是把责任推给下家。不允许出现某一个具体处理者对象在承担了一部分责任后又 把责任向下传的情况。</p><p style="color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;;">　　在一个纯的责任链模式里面，一个请求必须被某一个处理者对象所接收；在一个不纯的责任链模式里面，一个请求可以最终不被任何接收端对象所接收。</p><div style="color: rgb(51, 51, 51); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); word-wrap: break-word; margin: 5px auto; font-family: &apos;ms shell dlg&apos;; font-size: 14px;"><div>　　纯的责任链模式的实际例子很难找到，一般看到的例子均是不纯的责任链模式的实现。有些人认为不纯的责任链根本不是责任链模式，这也许是有道理的。但是在实际的系统里，纯的责任链很难找到。如果坚持责任链不纯便不是责任链模式，那么责任链模式便不会有太大意义了。</div></div></div></span>
</div></body></html> 